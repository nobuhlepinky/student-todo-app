{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h1
  style="
    font-size: 2rem;
    font-weight: 800;
    color: #1f2937;
    margin-bottom: 1.5rem;
    border-bottom: 2px solid #e5e7eb;
    padding-bottom: 0.5rem;
  "
>
  Welcome Back, {{ user.username }}!
</h1>

<!-- Metric Cards Displaying Task Counts -->
<div
  style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2.5rem;
  "
>
  <!-- Task Metric Card: Pending -->
  <div
    style="
      background-color: #fef3c7;
      border: 1px solid #fcd34d;
      padding: 1.5rem;
      border-radius: 8px;
      text-align: center;
    "
  >
    <p
      style="
        font-size: 0.875rem;
        color: #92400e;
        margin-bottom: 0.5rem;
        font-weight: 500;
      "
    >
      PENDING TASKS
    </p>
    <!-- These variables are passed from the dashboard view function -->
    <p style="font-size: 3rem; font-weight: 800; color: #b45309; margin: 0">
      {{ pending_tasks }}
    </p>
  </div>

  <!-- Task Metric Card: Total -->
  <div
    style="
      background-color: #dbeafe;
      border: 1px solid #93c5fd;
      padding: 1.5rem;
      border-radius: 8px;
      text-align: center;
    "
  >
    <p
      style="
        font-size: 0.875rem;
        color: #1e40af;
        margin-bottom: 0.5rem;
        font-weight: 500;
      "
    >
      TOTAL TASKS
    </p>
    <p style="font-size: 3rem; font-weight: 800; color: #2563eb; margin: 0">
      {{ total_tasks }}
    </p>
  </div>

  <!-- Task Metric Card: Completed -->
  <div
    style="
      background-color: #d1fae5;
      border: 1px solid #6ee7b7;
      padding: 1.5rem;
      border-radius: 8px;
      text-align: center;
    "
  >
    <p
      style="
        font-size: 0.875rem;
        color: #047857;
        margin-bottom: 0.5rem;
        font-weight: 500;
      "
    >
      COMPLETED
    </p>
    <p style="font-size: 3rem; font-weight: 800; color: #059669; margin: 0">
      {{ completed_tasks }}
    </p>
  </div>
</div>

<!-- Task and Notes Action Panels -->
<div style="display: grid; grid-template-columns: 1fr; gap: 2rem">
  <!-- Quick Task Actions -->
  <div>
    <div
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
      "
    >
      <h2 style="font-size: 1.5rem; font-weight: 700; color: #4f46e5">
        Tasks Overview
      </h2>
      <!-- Link to the Task Create View -->
      <a
        href="{% url 'todo_app:task_create' %}"
        style="
          background-color: #4f46e5;
          color: white;
          font-weight: 500;
          padding: 8px 16px;
          border-radius: 6px;
          text-decoration: none;
          transition: background-color 0.2s;
        "
      >
        + Add Task
      </a>
    </div>

    {% if pending_tasks > 0 %}
    <p style="color: #ef4444; font-weight: 600; margin-bottom: 1rem">
      You have {{ pending_tasks }} assignments requiring attention!
    </p>
    {% else %}
    <p style="color: #059669; font-weight: 600; margin-bottom: 1rem">
      Great job! All tasks are currently complete.
    </p>
    {% endif %}

    <!-- Link to the Full Task List View -->
    <a
      href="{% url 'todo_app:task_list' %}"
      style="
        display: block;
        background-color: #e0e7ff;
        color: #4f46e5;
        font-weight: 600;
        text-align: center;
        padding: 12px;
        border-radius: 6px;
        text-decoration: none;
        transition: background-color 0.2s;
      "
    >
      Go to Full Task List
    </a>
  </div>

  <!-- Recent Notes Placeholder/List -->
  <div>
    <div
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
      "
    >
      <h2 style="font-size: 1.5rem; font-weight: 700; color: #4f46e5">
        Recent Notes
      </h2>
      <!-- Placeholder link - we will update this next! -->
      <a
        href="#"
        style="
          background-color: #4f46e5;
          color: white;
          font-weight: 500;
          padding: 8px 16px;
          border-radius: 6px;
          text-decoration: none;
          transition: background-color 0.2s;
        "
      >
        + Create Note (Coming Soon)
      </a>
    </div>

    {% if recent_notes %}
    <div
      style="border: 1px solid #e5e7eb; border-radius: 6px; overflow: hidden"
    >
      {% for note in recent_notes %}
      <div
        style="
          background-color: #f9fafb;
          padding: 12px 15px;
          border-bottom: 1px solid #e5e7eb;
        "
      >
        <span style="font-weight: 600; color: #3730a3"
          >{{ note.title|truncatechars:30 }}</span
        >
        <span style="font-size: 0.8rem; color: #6b7280; margin-left: 10px"
          >({{ note.created_at|date:"M d" }})</span
        >
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p style="color: #6b7280">
      No recent notes yet. Start organizing your study material!
    </p>
    {% endif %}
  </div>
</div>

{% endblock %}
