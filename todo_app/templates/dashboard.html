{% extends "base.html" %}

{% block title %}Dashboard - StudyHub{% endblock %}

{% block content %}
<div class="space-y-12">
    <!-- Welcome Header -->
    <div class="text-center py-10 bg-white rounded-xl shadow-lg">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Welcome Back, {{ user.username }}!</h1>
        <p class="text-xl text-gray-600">Your StudyHub is ready. Let's get organized.</p>
    </div>

    <!-- Overview Section (Responsive Grid) -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        
        <!-- Task Overview Card -->
        <div class="bg-white rounded-xl shadow-2xl p-6 transition-all duration-300 hover:shadow-3xl hover:border-primary border-t-4 border-primary/50">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i data-lucide="list-todo" class="w-6 h-6 mr-3 text-primary"></i>
                    Your Tasks
                </h2>
                <a href="{% url 'note_app:task_list' %}" class="text-sm font-semibold text-primary hover:text-indigo-700 transition">View All <i data-lucide="arrow-right" class="w-4 h-4 inline-block ml-1"></i></a>
            </div>
            
            <!-- Stats -->
            <div class="flex justify-around text-center border-b pb-4 mb-4">
                <div>
                    <p class="text-4xl font-extrabold text-secondary">{{ total_tasks }}</p>
                    <p class="text-gray-500 text-sm">Total</p>
                </div>
                <div>
                    <p class="text-4xl font-extrabold text-red-500">{{ pending_tasks }}</p>
                    <p class="text-gray-500 text-sm">Pending</p>
                </div>
                <div>
                    <p class="text-4xl font-extrabold text-green-500">{{ completed_tasks }}</p>
                    <p class="text-gray-500 text-sm">Completed</p>
                </div>
            </div>

            <!-- Urgent Tasks List -->
            <h3 class="text-lg font-semibold text-gray-700 mb-3 flex items-center">
                <i data-lucide="alert-triangle" class="w-5 h-5 mr-2 text-accent"></i> High Priority Tasks (Upcoming)
            </h3>
            
            {% if urgent_tasks %}
                <ul class="space-y-2">
                    {% for task in urgent_tasks|slice:":5" %}
                    <li class="flex justify-between items-center bg-background-light p-3 rounded-lg border-l-4 border-accent shadow-sm">
                        <a href="{% url 'note_app:task_update' task.pk %}" class="flex-grow text-gray-800 hover:text-primary font-medium truncate">
                            {{ task.title }}
                        </a>
                        <span class="text-xs text-gray-500 ml-4">
                            Due: {{ task.due_date|default:"N/A"|date:'M d' }}
                        </span>
                    </li>
                    {% endfor %}
                    {% if urgent_tasks|length > 5 %}
                        <li class="text-center text-sm text-gray-500 pt-2"><a href="{% url 'note_app:task_list' %}" class="hover:underline">... and {{ urgent_tasks|length|add:"-5" }} more.</a></li>
                    {% endif %}
                </ul>
            {% else %}
                <p class="text-gray-500 p-4 border rounded-lg text-center">No urgent tasks right now. Great job!</p>
            {% endif %}

            <div class="mt-6 text-center">
                <a href="{% url 'note_app:task_create' %}" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-secondary hover:bg-emerald-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary transition duration-150">
                    <i data-lucide="plus" class="w-5 h-5 mr-2"></i> Add New Task
                </a>
            </div>
        </div>

        <!-- Note Overview Card -->
        <div class="bg-white rounded-xl shadow-2xl p-6 transition-all duration-300 hover:shadow-3xl hover:border-secondary border-t-4 border-secondary/50">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                    <i data-lucide="book-open" class="w-6 h-6 mr-3 text-secondary"></i>
                    Your Notes
                </h2>
                <a href="{% url 'note_app:note_list' %}" class="text-sm font-semibold text-secondary hover:text-emerald-600 transition">View All <i data-lucide="arrow-right" class="w-4 h-4 inline-block ml-1"></i></a>
            </div>

            <!-- Stats -->
            <div class="flex justify-around text-center border-b pb-4 mb-4">
                <div>
                    <p class="text-4xl font-extrabold text-primary">{{ total_notes }}</p>
                    <p class="text-gray-500 text-sm">Total Notes</p>
                </div>
            </div>

            <!-- Recent Notes List -->
            <h3 class="text-lg font-semibold text-gray-700 mb-3 flex items-center">
                <i data-lucide="folder-open" class="w-5 h-5 mr-2 text-primary"></i> Recently Edited Notes
            </h3>

            {% if recent_notes %}
                <ul class="space-y-2">
                    {% for note in recent_notes|slice:":5" %}
                    <li class="bg-background-light p-3 rounded-lg border-l-4 border-primary shadow-sm">
                        <a href="{% url 'note_app:note_detail' note.pk %}" class="flex-grow text-gray-800 hover:text-secondary font-medium truncate">
                            {{ note.title }}
                        </a>
                        <span class="text-xs text-gray-500 block mt-1">
                            Tag: {{ note.tag|default:"Untagged" }}
                        </span>
                    </li>
                    {% endfor %}
                    {% if recent_notes|length > 5 %}
                        <li class="text-center text-sm text-gray-500 pt-2"><a href="{% url 'note_app:note_list' %}" class="hover:underline">... and {{ recent_notes|length|add:"-5" }} more.</a></li>
                    {% endif %}
                </ul>
            {% else %}
                <p class="text-gray-500 p-4 border rounded-lg text-center">No notes found. Start writing down your ideas!</p>
            {% endif %}

            <div class="mt-6 text-center">
                <a href="{% url 'note_app:note_create' %}" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-primary hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition duration-150">
                    <i data-lucide="file-plus" class="w-5 h-5 mr-2"></i> Create New Note
                </a>
            </div>
        </div>
    </div>
</div>
<!-- Initialize Lucide Icons for the new content -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        lucide.createIcons();
    });
</script>
{% endblock content %}